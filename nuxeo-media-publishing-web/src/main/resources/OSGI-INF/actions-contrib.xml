<?xml version="1.0"?>
<component name="org.nuxeo.ecm.media.publishing.web.actions">

    <require>org.nuxeo.ecm.platform.actions</require>
    <require>org.nuxeo.ecm.platform.forms.layouts.webapp.summary</require>
    <require>org.nuxeo.ecm.platform.video.layouts</require>
    
    <extension point="filters" target="org.nuxeo.ecm.platform.actions.ActionService">

        <filter id="isPublishableMedia">
            <rule grant="true">
                <facet>PublishableMedia</facet>
            </rule>
        </filter>

    </extension>

    <extension target="org.nuxeo.ecm.platform.actions.ActionService" point="actions">

        <!-- add default publishing widget to publish tab layout -->
        <action id="tree_widget_publish" type="widget" order="10">
            <category>PUBLISH_PANEL_TOP</category>
            <properties>
                <property name="widgetName">publish_tree_widget</property>
            </properties>
        </action>

        <!-- add media publishing widget to publish tab layout -->
        <action id="media_widget_publish" type="widget" order="20">
            <category>PUBLISH_PANEL_TOP</category>
            <properties>
                <property name="widgetName">publish_media_widget</property>
            </properties>
            <filter-id>isPublishableMedia</filter-id>
        </action>

        <!-- add media publishing widget to summary layout -->
        <action id="media_widget_summary" type="widget" order="400">
            <category>SUMMARY_PANEL_LEFT</category>
            <properties>
                <property name="widgetName">summary_media_publishing_widget</property>
            </properties>
            <filter-id>isPublishableMedia</filter-id>
        </action>

        <!-- youtube options -->
        <action id="youtube_options" type="widget" order="10">
            <category>MEDIA_PUBLISHING_OPTIONS_CATEGORY</category>
            <properties>
                <property name="widgetName">youtube_options_widget</property>
            </properties>
            <filter id="isYoutubeOption">
                <rule grant="true">
                    <condition>#{provider == "YouTube"}</condition>
                </rule>
            </filter>
        </action>

        <!-- wistia options -->
        <action id="wistia_options" type="widget" order="20">
            <category>MEDIA_PUBLISHING_OPTIONS_CATEGORY</category>
            <properties>
                <property name="widgetName">wistia_options_widget</property>
            </properties>
            <filter id="isWistiaOption">
                <rule grant="true">
                    <condition>#{provider == "Wistia"}</condition>
                </rule>
            </filter>
        </action>

    </extension>

</component>
